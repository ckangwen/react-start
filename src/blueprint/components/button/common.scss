@import "../../common/variables";
@import "../../common/color";

$button-border-width: 1px !default;
$button-padding: ($grid-size / 2) $grid-size !default;
$button-padding-small: 0 ($grid-size * 0.7) !default;
$button-padding-large: ($grid-size / 2) ($grid-size * 1.5) !default;
$button-icon-spacing: ($button-height - $icon-size-standard) / 2 !default;
$button-icon-spacing-large: ($button-height-large - $icon-size-large) / 2 !default;


$button-box-shadow: inset 0 0 0 $button-border-width rgba($black, 0.2),
inset 0 (-$button-border-width) 0 rgba($black, 0.1) !default;
$button-box-shadow-active: inset 0 0 0 $button-border-width rgba($black, 0.2),
inset 0 1px 2px rgba($black, 0.2) !default;
$button-intent-box-shadow: inset 0 0 0 $button-border-width rgba($black, 0.4),
inset 0 (-$button-border-width) 0 rgba($black, 0.2) !default;
$button-intent-box-shadow-active: inset 0 0 0 $button-border-width rgba($black, 0.4),
inset 0 1px 2px rgba($black, 0.2) !default;

$button-box-shadow-overlay: 0 0 0 $button-border-width rgba($black, 0.2),
0 1px 1px rgba($black, 0.2) !default;
$button-box-shadow-overlay-active: 0 0 0 $button-border-width rgba($black, 0.2),
inset 0 1px 1px rgba($black, 0.1) !default;

$dark-button-box-shadow: 0 0 0 $button-border-width rgba($black, 0.4) !default;
$dark-button-box-shadow-active: 0 0 0 $button-border-width rgba($black, 0.6),
inset 0 1px 2px rgba($black, 0.2) !default;
$dark-button-intent-box-shadow: 0 0 0 $button-border-width rgba($black, 0.4) !default;
$dark-button-intent-box-shadow-active: 0 0 0 $button-border-width rgba($black, 0.4),
inset 0 1px 2px rgba($black, 0.2) !default;

$button-gradient: linear-gradient(to bottom, rgba($white, 0.8), rgba($white, 0)) !default;
$button-intent-gradient: linear-gradient(to bottom, rgba($white, 0.1), rgba($white, 0)) !default;
$dark-button-gradient: linear-gradient(to bottom, rgba($white, 0.05), rgba($white, 0)) !default;

$button-color-disabled: $text-color-disabled !default;
$button-background-color: $light-gray5 !default;
$button-background-color-hover: $light-gray4 !default;
$button-background-color-active: $light-gray2 !default;
$button-background-color-disabled: rgba($light-gray1, 0.5) !default;
$button-background-color-active-disabled: rgba($light-gray1, 0.7) !default;
$button-intent-color-disabled: rgba($white, 0.6);


// "intent": (default, hover, active colors)
$button-intents: ("primary": ($intent-primary, $blue2, $blue1),
  "success": ($intent-success, $green2, $green1),
  "warning": ($intent-warning, $orange2, $orange1),
  "danger": ($intent-danger, $red2, $red1)) !default;


/*
 * this element becomes a flex container in the given direction
 * supply `$margin` to put space between each child
 * supply `$inline: inline` to use `display: flex-inline`.
 * customize `flex: 1 1` child selector with $fill.
*/
@mixin flex-container($dir: row, $margin: none, $inline: none, $fill: '.#{$ns}-fill') {
  @if $inline==inline or $inline==true {
    display: inline-flex;
  }

  @else {
    display: flex;
  }

  flex-direction: $dir;

  >* {
    /* the flex-grow CSS property sets the flex grow factor(弹性增长因子) of a flex item main size */
    /* it specifies how much of the remaining space in the flex container should be assigned to the item */
    flex-grow: 0;
    /* the flex-grow CSS property sets the flex shrink factor of a flex item main size */
    /* If the size of all flex items are larger than the flex container, items shrink to fit according to flex-shrink */
    flex-shrink: 0;
  }

  >#{$fill} {
    flex-grow: 1;
    flex-shrink: 1;
  }

  @if $margin !=none {
    @include flex-margin($dir, $margin)
  }
}

/*
 * applies margin along axis of direction between every direct child
 * with no margins on either end
 * $dir: row | column
 * $margin: margin[-right | -bottom] value
*/
@mixin flex-margin($dir, $margin) {

  // $margin-prop: if ($dir==row, margin-right, margin-bottom);
  $margin-prop: if($dir==row, margin-right, margin-bottom);


  &::before,
  >* {
    // space after all children
    #{$margin-prop}: $margin
  }

  &:empty::before,
  > :last-child {
    #{$margin-prop}: 0
  }
}

@mixin button-base {
  @include flex-container(row, $button-icon-spacing, $inline: inline);
  align-content: center;
  justify-content: center;

  border: 0;
  border-radius: $border-radius;
  cursor: pointer;
  padding: $button-padding;
  vertical-align: middle;
  text-align: left;
  font-size: $font-size;
}

@mixin button-height($height) {
  min-width: $height;
  min-width: $height;
}

@mixin default-button() {
  box-shadow: $button-box-shadow;
  background-color: $button-background-color;
  background-image: $button-gradient;
  color: $text-color;

  &:hover {
    @include button-hover();
  }

  &:active,
  &.#{$ns}-active {
    @include button-active();
  }

  &:disabled,
  &.#{$ns}-disabled {
    @include button-disabled();
  }
}

@mixin button-hover() {
  box-shadow: $button-box-shadow;
  background-clip: padding-box;
  background-color: $button-background-color-hover;
}

@mixin button-active() {
  box-shadow: $button-box-shadow-active;
  background-color: $button-background-color-active;
  background-image: none;
}

@mixin button-disabled() {
  outline: none;
  box-shadow: none;
  background-color: $button-background-color-disabled;
  background-image: none;
  cursor: not-allowed;
  color: $button-color-disabled;

  &.#{$ns}-active,
  &.#{$ns}-active:hover {
    background: $button-background-color-active-disabled;
  }
}

@mixin button-intent($default-color, $hover-color, $active-color) {
  box-shadow: $button-intent-box-shadow;
  background-color: $default-color;
  background-image: $button-intent-gradient;
  color: $white;

  &:hover,
  &:active,
  &.#{$ns}-active {
    color: $white;
  }

  &:hover {
    box-shadow: $button-intent-box-shadow;
    background-color: $hover-color;
  }

  &:active,
  &.#{$ns}-active {
    box-shadow: $button-intent-box-shadow-active;
    background-color: $active-color;
    background-image: none;
  }

  &:disabled,
  &.#{$ns}-disabled {
    @include button-intent-disabled($default-color);
  }
}

@mixin button-intent-disabled($default-color) {
  border-color: transparent;
  box-shadow: none;
  background-color: rgba($default-color, 0.5);
  background-image: none;
  color: $button-intent-color-disabled;
}
